"use strict";(self.webpackChunkstore_inventory_system=self.webpackChunkstore_inventory_system||[]).push([[359],{1334:(e,s,a)=>{a.d(s,{h:()=>t});class t{static async hashPassword(e){const s=(new TextEncoder).encode(e+"salt_for_store_system"),a=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}static async verifyPassword(e,s){return await this.hashPassword(e)===s}static generateTempPassword(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let a=0;a<8;a++)s+=e.charAt(Math.floor(36*Math.random()));return s}static validatePassword(e){const s=[];return e.length<4&&s.push("\ube44\ubc00\ubc88\ud638\ub294 \ucd5c\uc18c 4\uc790\ub9ac \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."),e.length>20&&s.push("\ube44\ubc00\ubc88\ud638\ub294 20\uc790\ub9ac\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),{valid:0===s.length,errors:s}}}},1359:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var t=a(5043),r=a(4161),n=a(579);const i=e=>{let{users:s,onCreateUser:a,onEditUser:t,onDeleteUser:r,onResetPassword:i}=e;const l=e=>new Date(e).toLocaleDateString("ko-KR"),o=e=>{var s,a;return"MONTHLY"===e.salary_type?"\uc6d4 ".concat((null===(s=e.monthly_salary)||void 0===s?void 0:s.toLocaleString())||0,"\uc6d0"):"\uc2dc\uae09 ".concat((null===(a=e.hourly_wage)||void 0===a?void 0:a.toLocaleString())||0,"\uc6d0")};return(0,n.jsxs)("div",{className:"modern-user-list",children:[(0,n.jsxs)("div",{className:"list-header-modern",children:[(0,n.jsxs)("div",{className:"header-left",children:[(0,n.jsx)("h2",{className:"list-title",children:"\ud300 \uba64\ubc84"}),(0,n.jsxs)("div",{className:"list-stats",children:[(0,n.jsxs)("span",{className:"stat-item",children:[(0,n.jsx)("span",{className:"stat-icon",children:"\ud83d\udc64"}),(0,n.jsxs)("span",{className:"stat-text",children:[s.length,"\uba85"]})]}),(0,n.jsxs)("span",{className:"stat-item",children:[(0,n.jsx)("span",{className:"stat-icon",children:"\u2705"}),(0,n.jsxs)("span",{className:"stat-text",children:[s.filter(e=>e.is_active).length,"\uba85 \ud65c\uc131"]})]})]})]}),(0,n.jsxs)("button",{onClick:a,className:"modern-add-button",children:[(0,n.jsxs)("svg",{className:"add-icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,n.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),(0,n.jsx)("span",{children:"\uc0c8 \uc9c1\uc6d0 \ucd94\uac00"})]})]}),0===s.length?(0,n.jsxs)("div",{className:"modern-empty-state",children:[(0,n.jsx)("div",{className:"empty-illustration",children:(0,n.jsx)("div",{className:"empty-circle",children:(0,n.jsxs)("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",children:[(0,n.jsx)("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),(0,n.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})})}),(0,n.jsx)("h3",{className:"empty-title",children:"\uc544\uc9c1 \ub4f1\ub85d\ub41c \uc9c1\uc6d0\uc774 \uc5c6\uc5b4\uc694"}),(0,n.jsx)("p",{className:"empty-description",children:"\uccab \ubc88\uc9f8 \ud300 \uba64\ubc84\ub97c \ucd94\uac00\ud558\uc5ec \uc2dc\uc791\ud574\ubcf4\uc138\uc694"}),(0,n.jsxs)("button",{onClick:a,className:"modern-primary-button",children:[(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),(0,n.jsx)("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"\uccab \uc9c1\uc6d0 \ub4f1\ub85d\ud558\uae30"]})]}):(0,n.jsx)("div",{className:"modern-user-grid",children:s.map((e,s)=>(0,n.jsxs)("div",{className:"modern-user-card ".concat(e.is_active?"":"inactive"),style:{animationDelay:"".concat(.1*s,"s")},children:[(0,n.jsxs)("div",{className:"card-header",children:[(0,n.jsxs)("div",{className:"user-avatar-modern",children:[(0,n.jsx)("div",{className:"avatar-gradient",children:(0,n.jsx)("span",{className:"avatar-text",children:e.full_name.charAt(0)})}),(0,n.jsx)("div",{className:"status-indicator",children:(0,n.jsx)("div",{className:"status-dot ".concat(e.is_active?"active":"inactive")})})]}),(0,n.jsxs)("div",{className:"user-info",children:[(0,n.jsx)("h3",{className:"user-name",children:e.full_name}),(0,n.jsx)("span",{className:"user-position",children:e.position}),(0,n.jsxs)("span",{className:"user-id",children:["@",e.username]})]}),(0,n.jsx)("div",{className:"card-menu",children:(0,n.jsx)("button",{className:"menu-trigger",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,n.jsx)("circle",{cx:"12",cy:"5",r:"1"}),(0,n.jsx)("circle",{cx:"12",cy:"19",r:"1"})]})})})]}),(0,n.jsxs)("div",{className:"card-content",children:[(0,n.jsxs)("div",{className:"info-grid",children:[(0,n.jsxs)("div",{className:"info-item",children:[(0,n.jsx)("div",{className:"info-icon",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,n.jsx)("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),(0,n.jsx)("polyline",{points:"22,6 12,13 2,6"})]})}),(0,n.jsxs)("div",{className:"info-text",children:[(0,n.jsx)("span",{className:"info-label",children:"\uc774\uba54\uc77c"}),(0,n.jsx)("span",{className:"info-value",children:e.email})]})]}),(0,n.jsxs)("div",{className:"info-item",children:[(0,n.jsx)("div",{className:"info-icon",children:(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:(0,n.jsx)("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})}),(0,n.jsxs)("div",{className:"info-text",children:[(0,n.jsx)("span",{className:"info-label",children:"\uc5f0\ub77d\ucc98"}),(0,n.jsx)("span",{className:"info-value",children:e.phone})]})]}),(0,n.jsxs)("div",{className:"info-item",children:[(0,n.jsx)("div",{className:"info-icon",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,n.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,n.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,n.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,n.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]})}),(0,n.jsxs)("div",{className:"info-text",children:[(0,n.jsx)("span",{className:"info-label",children:"\uc785\uc0ac\uc77c"}),(0,n.jsx)("span",{className:"info-value",children:l(e.hire_date)})]})]}),(0,n.jsxs)("div",{className:"info-item",children:[(0,n.jsx)("div",{className:"info-icon",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[(0,n.jsx)("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),(0,n.jsx)("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),(0,n.jsxs)("div",{className:"info-text",children:[(0,n.jsx)("span",{className:"info-label",children:"\uae09\uc5ec"}),(0,n.jsx)("span",{className:"info-value wage",children:o(e)})]})]})]}),(0,n.jsxs)("div",{className:"login-status",children:[(0,n.jsxs)("div",{className:"status-item",children:[(0,n.jsx)("span",{className:"status-label",children:"\ub85c\uadf8\uc778 \uad8c\ud55c"}),(0,n.jsxs)("div",{className:"status-badge ".concat(e.password_hash?"enabled":"disabled"),children:[(0,n.jsx)("div",{className:"badge-dot"}),e.password_hash?"\ud65c\uc131":"\ube44\ud65c\uc131",e.password_hash&&e.is_password_temp&&(0,n.jsx)("span",{className:"temp-badge",children:"\uc784\uc2dc"})]})]}),e.last_login&&(0,n.jsxs)("div",{className:"last-login",children:["\ub9c8\uc9c0\ub9c9 \ub85c\uadf8\uc778: ",l(e.last_login)]})]})]}),(0,n.jsxs)("div",{className:"card-actions",children:[(0,n.jsxs)("button",{onClick:()=>t(e),className:"action-button edit",title:"\ud3b8\uc9d1",children:[(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,n.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,n.jsx)("span",{children:"\ud3b8\uc9d1"})]}),e.password_hash&&i&&(0,n.jsxs)("button",{onClick:()=>i(e),className:"action-button reset",title:"\ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815",children:[(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("polyline",{points:"23 4 23 10 17 10"}),(0,n.jsx)("polyline",{points:"1 20 1 14 7 14"}),(0,n.jsx)("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]}),(0,n.jsx)("span",{children:"\ube44\ubc00\ubc88\ud638"})]}),(0,n.jsxs)("button",{onClick:()=>r(e),className:"action-button delete",title:"\uc0ad\uc81c",children:[(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("polyline",{points:"3,6 5,6 21,6"}),(0,n.jsx)("path",{d:"M19,6V20a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6M8,6V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"})]}),(0,n.jsx)("span",{children:"\uc0ad\uc81c"})]})]}),(0,n.jsx)("div",{className:"card-footer",children:(0,n.jsxs)("span",{className:"registration-date",children:["\ub4f1\ub85d\uc77c: ",l(e.created_at||"")]})})]},e.id))})]})};var l=a(6353);const o=(0,t.lazy)(()=>a.e(332).then(a.bind(a,5332))),c=(0,t.lazy)(()=>a.e(134).then(a.bind(a,8134))),d=(0,t.lazy)(()=>a.e(846).then(a.bind(a,3846))),h=(0,t.lazy)(()=>a.e(676).then(a.bind(a,5676))),m=()=>{const[e,s]=(0,t.useState)("users"),[a,m]=(0,t.useState)([]),[x,u]=(0,t.useState)([]),[g,p]=(0,t.useState)(null),[j,w]=(0,t.useState)(!1),[y,v]=(0,t.useState)(!1),[f,N]=(0,t.useState)(null),[_,b]=(0,t.useState)(!0),[k,C]=(0,t.useState)(null);(0,t.useEffect)(()=>{S()},[]);const S=async()=>{try{b(!0),C(null);const[e,s]=await Promise.all([r.D.getAllUsers(),r.D.getUsersWithCurrentSchedule()]);m(e),u(s)}catch(e){C("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),console.error("Error loading users:",e)}finally{b(!1)}},U=()=>(0,n.jsxs)("div",{className:"component-loading",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"\ucef4\ud3ec\ub10c\ud2b8\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})]});return _?(0,n.jsxs)("div",{className:"loading-container",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})]}):(0,n.jsxs)("div",{className:"user-management-modern",children:[(0,n.jsxs)("div",{className:"background-effects",children:[(0,n.jsx)("div",{className:"gradient-orb orb-1"}),(0,n.jsx)("div",{className:"gradient-orb orb-2"}),(0,n.jsx)("div",{className:"gradient-orb orb-3"})]}),(0,n.jsx)("div",{className:"modern-header",children:(0,n.jsxs)("div",{className:"header-content",children:[(0,n.jsxs)("div",{className:"header-text",children:[(0,n.jsxs)("h1",{className:"modern-title",children:[(0,n.jsx)("span",{className:"title-icon",children:"\ud83d\udc65"}),"\uc9c1\uc6d0 \uad00\ub9ac"]}),(0,n.jsx)("p",{className:"modern-subtitle",children:"\ud300\uc6d0\ub4e4\uc758 \uc815\ubcf4\uc640 \uc2a4\ucf00\uc904\uc744 \uc2a4\ub9c8\ud2b8\ud558\uac8c \uad00\ub9ac\ud558\uc138\uc694"})]}),(0,n.jsxs)("div",{className:"header-stats",children:[(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-number",children:a.length}),(0,n.jsx)("div",{className:"stat-label",children:"\ucd1d \uc9c1\uc6d0"})]}),(0,n.jsxs)("div",{className:"stat-card",children:[(0,n.jsx)("div",{className:"stat-number",children:a.filter(e=>e.is_active).length}),(0,n.jsx)("div",{className:"stat-label",children:"\ud65c\uc131 \uc9c1\uc6d0"})]})]})]})}),k&&(0,n.jsx)("div",{className:"error-toast",children:(0,n.jsxs)("div",{className:"error-content",children:[(0,n.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,n.jsx)("span",{className:"error-text",children:k}),(0,n.jsx)("button",{onClick:()=>C(null),className:"error-close",children:(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,n.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,n.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}),(0,n.jsx)("div",{className:"modern-tabs",children:(0,n.jsx)("div",{className:"tab-container",children:[{key:"users",icon:"\ud83d\udc64",label:"\uc9c1\uc6d0 \uad00\ub9ac",color:"blue"},{key:"schedule",icon:"\ud83d\udcc5",label:"\uc8fc\uac04 \uc2a4\ucf00\uc904",color:"purple"},{key:"fixed-schedule",icon:"\ud83d\udd12",label:"\uace0\uc815 \uc2a4\ucf00\uc904",color:"orange"},{key:"analysis",icon:"\ud83d\udcca",label:"\uadfc\ubb34 \ubd84\uc11d",color:"green"}].map(a=>(0,n.jsxs)("button",{className:"modern-tab ".concat(e===a.key?"active":""," ").concat(a.color),onClick:()=>s(a.key),children:[(0,n.jsx)("span",{className:"tab-icon",children:a.icon}),(0,n.jsx)("span",{className:"tab-label",children:a.label}),e===a.key&&(0,n.jsx)("div",{className:"tab-indicator"})]},a.key))})}),(0,n.jsx)("div",{className:"modern-content",children:(0,n.jsxs)("div",{className:"content-wrapper",children:["users"===e&&(0,n.jsx)(i,{users:a,onCreateUser:()=>{p(null),w(!0)},onEditUser:e=>{p(e),w(!0)},onDeleteUser:e=>{N(e),v(!0)},onResetPassword:async e=>{if(window.confirm('"'.concat(e.full_name,'" \uc9c1\uc6d0\uc758 \ube44\ubc00\ubc88\ud638\ub97c \uc7ac\uc124\uc815\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?\n\uc0c8\ub85c\uc6b4 \uc784\uc2dc \ube44\ubc00\ubc88\ud638\uac00 \uc0dd\uc131\ub429\ub2c8\ub2e4.')))try{const s=await r.D.resetPassword(e.id);alert("\ube44\ubc00\ubc88\ud638\uac00 \uc7ac\uc124\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\uc0c8\ub85c\uc6b4 \uc784\uc2dc \ube44\ubc00\ubc88\ud638: ".concat(s,"\n\n\uc774 \uc815\ubcf4\ub97c \uc9c1\uc6d0\uc5d0\uac8c \uc548\uc804\ud558\uac8c \uc804\ub2ec\ud574\uc8fc\uc138\uc694.")),await S()}catch(s){C("\ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),console.error("Error resetting password:",s)}}}),"schedule"===e&&(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(U,{}),children:(0,n.jsx)(c,{users:x,onScheduleUpdate:S})}),"fixed-schedule"===e&&(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(U,{}),children:(0,n.jsx)(d,{users:a})}),"analysis"===e&&(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(U,{}),children:(0,n.jsx)(h,{})})]})}),j&&(0,n.jsx)(t.Suspense,{fallback:(0,n.jsx)(U,{}),children:(0,n.jsx)(o,{user:g,onSubmit:async(e,s)=>{try{if(g){if(await r.D.updateUser(g.id,e),void 0!==s){s!==!!g.password_hash&&await r.D.toggleUserLoginAccess(g.id,s)}}else{const a=await r.D.createUser(e,s);s&&a.password_temp&&alert("\uc9c1\uc6d0\uc774 \ub4f1\ub85d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\n\n\uc784\uc2dc \ub85c\uadf8\uc778 \uc815\ubcf4:\n\uc774\uba54\uc77c: ".concat(a.email,"\n\ube44\ubc00\ubc88\ud638: ").concat(a.password_temp,"\n\n\uc774 \uc815\ubcf4\ub97c \uc9c1\uc6d0\uc5d0\uac8c \uc548\uc804\ud558\uac8c \uc804\ub2ec\ud574\uc8fc\uc138\uc694."))}await S(),w(!1),p(null)}catch(a){C("\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),console.error("Error saving user:",a)}},onCancel:()=>{w(!1),p(null)}})}),(0,n.jsx)(l.A,{isOpen:y,title:"\uc9c1\uc6d0 \uc0ad\uc81c \ud655\uc778",message:'\uc815\ub9d0\ub85c "'.concat(null===f||void 0===f?void 0:f.full_name,'" \uc9c1\uc6d0\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c? \uc774 \uc791\uc5c5\uc740 \ub418\ub3cc\ub9b4 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.'),onConfirm:async()=>{if(f)try{await r.D.deleteUser(f.id),await S(),v(!1),N(null)}catch(e){C("\uc0ac\uc6a9\uc790 \uc0ad\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),console.error("Error deleting user:",e)}},onCancel:()=>{v(!1),N(null)},confirmText:"\uc0ad\uc81c",cancelText:"\ucde8\uc18c",type:"danger"})]})}},4161:(e,s,a)=>{a.d(s,{D:()=>i});var t=a(2555),r=a(7800),n=a(1334);class i{static async getAllUsers(){try{const{data:e,error:s}=await r.N.from(this.tableName).select("*").order("created_at",{ascending:!1});if(s)throw s;return e||[]}catch(e){return console.error("Error getting all users:",e),[]}}static async getUserById(e){try{const{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("id",e).single();if(a)throw a;return s}catch(s){return console.error("Error getting user by ID:",s),null}}static async createUser(e){var s;let a=null,i=null,l=!1;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(i=n.h.generateTempPassword(),a=await n.h.hashPassword(i),l=!0);const o=(0,t.A)((0,t.A)({},e),{},{password_hash:a,password_temp:i,is_password_temp:l,is_active:null===(s=e.is_active)||void 0===s||s,hourly_wage:e.hourly_wage||0,monthly_salary:e.monthly_salary||0,salary_type:e.salary_type||"HOURLY"});try{const{data:e,error:s}=await r.N.from(this.tableName).insert(o).select().single();if(s){if("23505"===s.code)throw new Error("\uc774\ubbf8 \uc874\uc7ac\ud558\ub294 \uc0ac\uc6a9\uc790\uc785\ub2c8\ub2e4.");throw s}return(0,t.A)((0,t.A)({},e),{},{password_temp:i})}catch(c){throw console.error("Error creating user:",c),c}}static async updateUser(e,s){try{const{data:a,error:t}=await r.N.from(this.tableName).update(s).eq("id",e).select().single();if(t)throw t;return a}catch(a){throw console.error("Error updating user:",a),a}}static async deleteUser(e){try{const{error:s}=await r.N.from(this.tableName).delete().eq("id",e);if(s)throw s;return!0}catch(s){return console.error("Error deleting user:",s),!1}}static async getUsersWithCurrentSchedule(){try{const e=this.getCurrentWeekStart(),{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("is_active",!0);if(a)throw a;const t=[];for(const n of s||[]){const s=n,{data:a}=await r.N.from("work_schedules").select("*").eq("user_id",n.id).eq("week_start_date",e);if(a&&a.length>0){const t=a[0];s.current_schedule={user_id:n.id,week_start_date:e,monday_start:t.monday_start,monday_end:t.monday_end,tuesday_start:t.tuesday_start,tuesday_end:t.tuesday_end,wednesday_start:t.wednesday_start,wednesday_end:t.wednesday_end,thursday_start:t.thursday_start,thursday_end:t.thursday_end,friday_start:t.friday_start,friday_end:t.friday_end,saturday_start:t.saturday_start,saturday_end:t.saturday_end,sunday_start:t.sunday_start,sunday_end:t.sunday_end}}const i=await this.getUserWeeklyHours(n.id,e);s.total_hours_this_week=i.total_hours,s.total_pay_this_week=i.total_pay,t.push(s)}return t.sort((e,s)=>e.full_name.localeCompare(s.full_name))}catch(e){return console.error("Error getting users with current schedule:",e),[]}}static getCurrentWeekStart(){const e=new Date,s=e.getDay(),a=e.getDate()-s+(0===s?-6:1);return new Date(e.setDate(a)).toISOString().split("T")[0]}static async getUserWeeklyHours(e,s){try{const a=new Date(s);a.setDate(a.getDate()+6);const t=a.toISOString().split("T")[0],{data:n}=await r.N.from("work_records").select("*").eq("user_id",e).gte("work_date",s).lte("work_date",t),i=(n||[]).reduce((e,s)=>e+(s.total_hours||0),0);return{total_hours:i,total_pay:(n||[]).reduce((e,s)=>e+(s.total_pay||0),0)}}catch(a){return console.error("Error getting user weekly hours:",a),{total_hours:0,total_pay:0}}}static async getUserByEmail(e){try{const{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("email",e).eq("is_active",!0).single();if(a)throw a;return s}catch(s){return console.error("Error getting user by email:",s),null}}static async authenticateUser(e,s){const a=await this.getUserByEmail(e);if(!a||!a.password_hash)return null;return await n.h.verifyPassword(s,a.password_hash)?(await this.updateLastLogin(a.id),a):null}static async updateLastLogin(e){try{const{error:s}=await r.N.from(this.tableName).update({last_login:(new Date).toISOString()}).eq("id",e);if(s)throw s}catch(s){console.error("Error updating last login:",s)}}static async resetPassword(e){const s=n.h.generateTempPassword(),a=await n.h.hashPassword(s);try{const{error:t}=await r.N.from(this.tableName).update({password_hash:a,password_temp:s,is_password_temp:!0}).eq("id",e);if(t)throw t;return s}catch(t){throw console.error("Error resetting password:",t),t}}static async changePassword(e,s){const a=n.h.validatePassword(s);if(!a.valid)throw new Error(a.errors.join(", "));const t=await n.h.hashPassword(s);try{const{error:s}=await r.N.from(this.tableName).update({password_hash:t,password_temp:null,is_password_temp:!1}).eq("id",e);if(s)throw s;return!0}catch(i){throw console.error("Error changing password:",i),i}}static async toggleUserLoginAccess(e,s){try{if(s){const s=n.h.generateTempPassword(),a=await n.h.hashPassword(s),{error:t}=await r.N.from(this.tableName).update({password_hash:a,password_temp:s,is_password_temp:!0}).eq("id",e);if(t)throw t}else{const{error:s}=await r.N.from(this.tableName).update({password_hash:null,password_temp:null,is_password_temp:!0}).eq("id",e);if(s)throw s}}catch(a){throw console.error("Error toggling user login access:",a),a}}}i.tableName="users"},6353:(e,s,a)=>{a.d(s,{A:()=>r});a(5043);var t=a(579);const r=e=>{let{isOpen:s,title:a,message:r,confirmText:n="\ud655\uc778",cancelText:i="\ucde8\uc18c",onConfirm:l,onCancel:o,type:c="warning"}=e;if(!s)return null;return(0,t.jsxs)("div",{className:"dialog-overlay",onClick:e=>{e.target===e.currentTarget&&o()},children:[(0,t.jsxs)("div",{className:"dialog-content dialog-".concat(c),children:[(0,t.jsx)("div",{className:"dialog-header",children:(0,t.jsx)("h3",{className:"dialog-title",children:a})}),(0,t.jsx)("div",{className:"dialog-body",children:(0,t.jsx)("p",{className:"dialog-message",children:r})}),(0,t.jsxs)("div",{className:"dialog-footer",children:[(0,t.jsx)("button",{className:"btn btn-secondary",onClick:o,children:i}),(0,t.jsx)("button",{className:"btn btn-".concat("danger"===c?"danger":"primary"),onClick:l,children:n})]})]}),(0,t.jsx)("style",{children:"\n        .dialog-overlay {\n          position: fixed;\n          top: 0;\n          left: 0;\n          right: 0;\n          bottom: 0;\n          background-color: rgba(0, 0, 0, 0.5);\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          z-index: 1000;\n          backdrop-filter: blur(2px);\n        }\n\n        .dialog-content {\n          background: white;\n          border-radius: 12px;\n          min-width: 400px;\n          max-width: 500px;\n          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n          animation: dialogSlideIn 0.3s ease-out;\n        }\n\n        @keyframes dialogSlideIn {\n          from {\n            opacity: 0;\n            transform: translateY(-50px) scale(0.9);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0) scale(1);\n          }\n        }\n\n        .dialog-header {\n          padding: 1.5rem 1.5rem 0 1.5rem;\n          border-bottom: 1px solid #eee;\n          margin-bottom: 1rem;\n        }\n\n        .dialog-title {\n          margin: 0;\n          font-size: 1.25rem;\n          font-weight: 600;\n          color: #333;\n        }\n\n        .dialog-warning .dialog-title {\n          color: #f57c00;\n        }\n\n        .dialog-danger .dialog-title {\n          color: #d32f2f;\n        }\n\n        .dialog-info .dialog-title {\n          color: #2196f3;\n        }\n\n        .dialog-body {\n          padding: 0 1.5rem 1.5rem;\n        }\n\n        .dialog-message {\n          margin: 0;\n          line-height: 1.5;\n          color: #555;\n          white-space: pre-line;\n        }\n\n        .dialog-footer {\n          padding: 1rem 1.5rem 1.5rem;\n          display: flex;\n          justify-content: flex-end;\n          gap: 0.75rem;\n        }\n\n        .btn {\n          border: none;\n          border-radius: 6px;\n          padding: 0.75rem 1.5rem;\n          cursor: pointer;\n          font-size: 0.9rem;\n          font-weight: 500;\n          transition: all 0.2s;\n          min-width: 80px;\n        }\n\n        .btn:hover {\n          transform: translateY(-1px);\n          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n        }\n\n        .btn-primary {\n          background: #2196f3;\n          color: white;\n        }\n\n        .btn-primary:hover {\n          background: #1976d2;\n        }\n\n        .btn-secondary {\n          background: #f5f5f5;\n          color: #666;\n          border: 1px solid #ddd;\n        }\n\n        .btn-secondary:hover {\n          background: #eee;\n        }\n\n        .btn-danger {\n          background: #f44336;\n          color: white;\n        }\n\n        .btn-danger:hover {\n          background: #d32f2f;\n        }\n\n        @media (max-width: 500px) {\n          .dialog-content {\n            min-width: auto;\n            width: 90vw;\n            margin: 1rem;\n          }\n\n          .dialog-footer {\n            flex-direction: column-reverse;\n          }\n\n          .btn {\n            width: 100%;\n          }\n        }\n      "})]})}}}]);
//# sourceMappingURL=359.c91ff889.chunk.js.map