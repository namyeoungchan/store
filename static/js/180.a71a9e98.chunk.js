"use strict";(self.webpackChunkstore_inventory_system=self.webpackChunkstore_inventory_system||[]).push([[180],{1334:(e,s,a)=>{a.d(s,{h:()=>t});class t{static async hashPassword(e){const s=(new TextEncoder).encode(e+"salt_for_store_system"),a=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(a)).map(e=>e.toString(16).padStart(2,"0")).join("")}static async verifyPassword(e,s){return await this.hashPassword(e)===s}static generateTempPassword(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let a=0;a<8;a++)s+=e.charAt(Math.floor(36*Math.random()));return s}static validatePassword(e){const s=[];return e.length<4&&s.push("\ube44\ubc00\ubc88\ud638\ub294 \ucd5c\uc18c 4\uc790\ub9ac \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."),e.length>20&&s.push("\ube44\ubc00\ubc88\ud638\ub294 20\uc790\ub9ac\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),{valid:0===s.length,errors:s}}}},2180:(e,s,a)=>{a.r(s),a.d(s,{default:()=>x});var t=a(5043),r=a(2555),i=a(4161);class n{static async login(e,s){try{const a=await i.D.authenticateUser(e,s);if(!a)return{success:!1,error:"\uc774\uba54\uc77c \ub610\ub294 \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."};if(!a.is_active)return{success:!1,error:"\ube44\ud65c\uc131\ud654\ub41c \uacc4\uc815\uc785\ub2c8\ub2e4. \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694."};const t={id:a.id.toString(),name:a.full_name,email:a.email,role:"employee"},r={token:this.generateToken(t.id),user:t,loginTime:Date.now(),expiryTime:Date.now()+this.SESSION_DURATION};return localStorage.setItem(this.USER_SESSION_KEY,JSON.stringify(r)),{success:!0,user:t}}catch(a){return console.error("Login error:",a),{success:!1,error:"\ub85c\uadf8\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."}}}static logout(){localStorage.removeItem(this.USER_SESSION_KEY)}static isAuthenticated(){const e=this.getSessionData();return!!e&&(!(Date.now()>e.expiryTime)||(this.logout(),!1))}static getCurrentUser(){const e=this.getSessionData();return e&&this.isAuthenticated()?(0,r.A)((0,r.A)({},e.user),{},{loginTime:e.loginTime}):null}static extendSession(){const e=this.getSessionData();e&&this.isAuthenticated()&&(e.expiryTime=Date.now()+this.SESSION_DURATION,localStorage.setItem(this.USER_SESSION_KEY,JSON.stringify(e)))}static getTimeUntilExpiry(){const e=this.getSessionData();return e?Math.max(0,e.expiryTime-Date.now()):0}static async getLoginEnabledUsers(){try{return(await i.D.getAllUsers()).filter(e=>e.password_hash&&e.is_active).map(e=>({email:e.email,name:e.full_name,hasTemp:!!e.is_password_temp}))}catch(e){return console.error("Error getting login enabled users:",e),[]}}static generateToken(e){return btoa("".concat(e,":").concat(Date.now(),":").concat(Math.random()))}static getSessionData(){try{const e=localStorage.getItem(this.USER_SESSION_KEY);return e?JSON.parse(e):null}catch(e){return null}}}n.USER_SESSION_KEY="user_auth_session",n.SESSION_DURATION=288e5;var l=a(579);const c=e=>{let{onLoginSuccess:s}=e;const[a,r]=(0,t.useState)(""),[i,c]=(0,t.useState)(""),[o,d]=(0,t.useState)(""),[h,m]=(0,t.useState)(!1),[u,x]=(0,t.useState)([]);(0,t.useEffect)(()=>{p()},[]);const p=async()=>{try{const e=await n.getLoginEnabledUsers();x(e)}catch(o){console.error("Error loading available users:",o)}};return(0,l.jsx)("div",{className:"user-login-container",children:(0,l.jsxs)("div",{className:"user-login-background",children:[(0,l.jsxs)("div",{className:"user-login-card",children:[(0,l.jsxs)("div",{className:"user-login-header",children:[(0,l.jsx)("div",{className:"user-login-icon",children:"\ud83d\udc68\u200d\ud83d\udcbc"}),(0,l.jsx)("h1",{children:"\uc9c1\uc6d0 \ub85c\uadf8\uc778"}),(0,l.jsx)("p",{children:"\uadfc\ubb34\uc2dc\uac04 \uad00\ub9ac \uc2dc\uc2a4\ud15c"})]}),(0,l.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(""),m(!0);try{const e=await n.login(a,i);e.success?s():(d(e.error||"\ub85c\uadf8\uc778\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4."),c(""))}catch(t){d("\ub85c\uadf8\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),console.error("Login error:",t)}finally{m(!1)}},className:"user-login-form",children:[(0,l.jsxs)("div",{className:"user-form-group",children:[(0,l.jsx)("label",{htmlFor:"email",className:"user-form-label",children:"\uc774\uba54\uc77c"}),(0,l.jsxs)("div",{className:"user-input-wrapper",children:[(0,l.jsx)("span",{className:"user-input-icon",children:"\ud83d\udce7"}),(0,l.jsx)("input",{id:"email",type:"email",value:a,onChange:e=>{r(e.target.value),o&&d("")},placeholder:"\uc774\uba54\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694",className:"user-form-input",required:!0,disabled:h})]})]}),(0,l.jsxs)("div",{className:"user-form-group",children:[(0,l.jsx)("label",{htmlFor:"password",className:"user-form-label",children:"\ube44\ubc00\ubc88\ud638"}),(0,l.jsxs)("div",{className:"user-input-wrapper",children:[(0,l.jsx)("span",{className:"user-input-icon",children:"\ud83d\udd12"}),(0,l.jsx)("input",{id:"password",type:"password",value:i,onChange:e=>{c(e.target.value),o&&d("")},placeholder:"\ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694",className:"user-form-input",required:!0,disabled:h})]})]}),o&&(0,l.jsxs)("div",{className:"user-error-message",children:[(0,l.jsx)("span",{className:"user-error-icon",children:"\u26a0\ufe0f"}),o]}),(0,l.jsx)("button",{type:"submit",className:"user-login-button ".concat(h?"loading":""),disabled:h||!a.trim()||!i.trim(),children:h?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"user-loading-spinner",children:"\u27f3"}),"\ub85c\uadf8\uc778 \uc911..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"user-login-button-icon",children:"\ud83d\ude80"}),"\ub85c\uadf8\uc778"]})})]}),u.length>0&&(0,l.jsxs)("div",{className:"quick-login-section",children:[(0,l.jsxs)("div",{className:"quick-login-header",children:[(0,l.jsx)("span",{className:"quick-login-icon",children:"\u26a1"}),(0,l.jsx)("span",{children:"\ube60\ub978 \ub85c\uadf8\uc778 (\ub4f1\ub85d\ub41c \uc9c1\uc6d0)"})]}),(0,l.jsx)("div",{className:"quick-login-buttons",children:u.slice(0,4).map(e=>(0,l.jsxs)("button",{type:"button",className:"quick-login-btn ".concat(e.hasTemp?"temp-password":""),onClick:()=>{return s=e.email,a=e.hasTemp,r(s),a?(alert("\uc774 \uc0ac\uc6a9\uc790\ub294 \uc784\uc2dc \ube44\ubc00\ubc88\ud638\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.\n\uad00\ub9ac\uc790\uc5d0\uac8c \uc784\uc2dc \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud558\uc138\uc694."),c("")):c(""),void d("");var s,a},disabled:h,children:[e.name,e.hasTemp&&(0,l.jsx)("span",{className:"temp-badge",children:"\uc784\uc2dc"})]},e.email))}),(0,l.jsxs)("div",{className:"demo-info",children:[(0,l.jsx)("span",{className:"demo-icon",children:"\ud83d\udca1"}),(0,l.jsx)("span",{children:u.some(e=>e.hasTemp)?"\uc784\uc2dc \ube44\ubc00\ubc88\ud638\uac00 \uc788\ub294 \uacc4\uc815\uc740 \uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud558\uc138\uc694":"\uad00\ub9ac\uc790\uac00 \ub4f1\ub85d\ud55c \uc9c1\uc6d0 \uacc4\uc815\ub4e4\uc785\ub2c8\ub2e4"})]})]}),(0,l.jsx)("div",{className:"user-login-footer",children:(0,l.jsxs)("div",{className:"user-security-info",children:[(0,l.jsx)("span",{className:"user-security-icon",children:"\ud83d\udee1\ufe0f"}),(0,l.jsx)("span",{children:"\uc548\uc804\ud55c \uadfc\ubb34\uc2dc\uac04 \uae30\ub85d \uc2dc\uc2a4\ud15c"})]})})]}),(0,l.jsxs)("div",{className:"user-bg-animation",children:[(0,l.jsx)("div",{className:"user-floating-shape shape-1",children:"\u23f0"}),(0,l.jsx)("div",{className:"user-floating-shape shape-2",children:"\ud83d\udcc5"}),(0,l.jsx)("div",{className:"user-floating-shape shape-3",children:"\ud83d\udc65"}),(0,l.jsx)("div",{className:"user-floating-shape shape-4",children:"\ud83d\udcbc"}),(0,l.jsx)("div",{className:"user-floating-shape shape-5",children:"\ud83d\udcca"}),(0,l.jsx)("div",{className:"user-floating-shape shape-6",children:"\ud83c\udfe2"})]})]})})};class o{static addWorkTime(e,s,a,t,r,i){const n=this.getAllRecords(),l=n.findIndex(a=>a.userId===e&&a.date===s),c=this.calculateWorkHours(a,t,r),o={id:l>=0?n[l].id:this.generateId(),userId:e,date:s,startTime:a,endTime:t,breakTime:r,totalHours:c,notes:i,createdAt:l>=0?n[l].createdAt:new Date,updatedAt:new Date};return l>=0?n[l]=o:n.push(o),this.saveRecords(n),o}static getUserWorkTimes(e,s){const a=this.getAllRecords().filter(s=>s.userId===e).sort((e,s)=>new Date(s.date).getTime()-new Date(e.date).getTime());return s?a.slice(0,s):a}static getWorkTimeByDate(e,s){return this.getAllRecords().find(a=>a.userId===e&&a.date===s)||null}static getWorkSummary(e){const s=this.getUserWorkTimes(e),a=new Date,t=new Date(a);t.setDate(a.getDate()-a.getDay()),t.setHours(0,0,0,0);const r=new Date(a.getFullYear(),a.getMonth(),1),i=s.reduce((e,s)=>e+s.totalHours,0),n=s.filter(e=>new Date(e.date)>=t).reduce((e,s)=>e+s.totalHours,0),l=s.filter(e=>new Date(e.date)>=r).reduce((e,s)=>e+s.totalHours,0);return{totalDays:s.length,totalHours:i,averageHours:s.length>0?i/s.length:0,thisWeekHours:n,thisMonthHours:l}}static getWeeklyData(e){const s=this.getUserWorkTimes(e),a=[],t=new Date;for(let r=6;r>=0;r--){const e=new Date(t);e.setDate(t.getDate()-r);const i=e.toISOString().split("T")[0],n=s.find(e=>e.date===i),l=["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"];a.push({date:i,hours:n?n.totalHours:0,dayName:l[e.getDay()]})}return a}static deleteWorkTime(e,s){const a=this.getAllRecords(),t=a.findIndex(a=>a.id===s&&a.userId===e);return t>=0&&(a.splice(t,1),this.saveRecords(a),!0)}static calculateWorkHours(e,s,a){const[t,r]=e.split(":").map(Number),[i,n]=s.split(":").map(Number),l=60*t+r;let c=60*i+n;c<l&&(c+=1440);const o=c-l-a;return Math.max(0,o/60)}static getAllRecords(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch(e){return[]}}static saveRecords(e){localStorage.setItem(this.STORAGE_KEY,JSON.stringify(e))}static generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}}o.STORAGE_KEY="work_time_records";var d=a(1334);const h=e=>{let{isOpen:s,userId:a,onClose:r,onSuccess:n}=e;const[c,o]=(0,t.useState)(""),[h,m]=(0,t.useState)(""),[u,x]=(0,t.useState)(""),[p,j]=(0,t.useState)(""),[N,g]=(0,t.useState)(!1),v=()=>{o(""),m(""),x(""),j(""),r()};return s?(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal-content password-change-modal",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h2",{children:"\ud83d\udd10 \ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"}),(0,l.jsx)("button",{onClick:v,className:"modal-close",children:"\xd7"})]}),(0,l.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),j(""),!c||!h||!u)return void j("\ubaa8\ub4e0 \ud544\ub4dc\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.");if(h!==u)return void j("\uc0c8 \ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");if(c===h)return void j("\uc0c8 \ube44\ubc00\ubc88\ud638\ub294 \ud604\uc7ac \ube44\ubc00\ubc88\ud638\uc640 \ub2ec\ub77c\uc57c \ud569\ub2c8\ub2e4.");const s=d.h.validatePassword(h);if(s.valid){g(!0);try{const e=await i.D.getUserById(a);if(!e||!e.password_hash)return void j("\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");if(!await d.h.verifyPassword(c,e.password_hash))return void j("\ud604\uc7ac \ube44\ubc00\ubc88\ud638\uac00 \uc62c\ubc14\ub974\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");await i.D.changePassword(a,h),alert("\ube44\ubc00\ubc88\ud638\uac00 \uc131\uacf5\uc801\uc73c\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),n(),r()}catch(t){j("\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),console.error("Password change error:",t)}finally{g(!1)}}else j(s.errors.join(" "))},className:"password-change-form",children:[p&&(0,l.jsxs)("div",{className:"error-message",children:[(0,l.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),p]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"currentPassword",children:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638 *"}),(0,l.jsx)("input",{type:"password",id:"currentPassword",value:c,onChange:e=>o(e.target.value),placeholder:"\ud604\uc7ac \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694",disabled:N})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"newPassword",children:"\uc0c8 \ube44\ubc00\ubc88\ud638 *"}),(0,l.jsx)("input",{type:"password",id:"newPassword",value:h,onChange:e=>m(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud558\uc138\uc694",disabled:N}),(0,l.jsx)("p",{className:"password-help",children:"\ucd5c\uc18c 4\uc790\ub9ac \uc774\uc0c1, \ucd5c\ub300 20\uc790\ub9ac \uc774\ud558\ub85c \uc785\ub825\ud574\uc8fc\uc138\uc694."})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"confirmPassword",children:"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778 *"}),(0,l.jsx)("input",{type:"password",id:"confirmPassword",value:u,onChange:e=>x(e.target.value),placeholder:"\uc0c8 \ube44\ubc00\ubc88\ud638\ub97c \ub2e4\uc2dc \uc785\ub825\ud558\uc138\uc694",disabled:N})]}),(0,l.jsxs)("div",{className:"form-actions",children:[(0,l.jsx)("button",{type:"button",onClick:v,className:"secondary-button",disabled:N,children:"\ucde8\uc18c"}),(0,l.jsx)("button",{type:"submit",className:"primary-button",disabled:N,children:N?"\ubcc0\uacbd \uc911...":"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"})]})]})]})}):null},m=()=>{const[e,s]=(0,t.useState)(null),[a,r]=(0,t.useState)([]),[i,c]=(0,t.useState)([]),[d,m]=(0,t.useState)(null),[u,x]=(0,t.useState)(null),[p,j]=(0,t.useState)(!1),N=n.getCurrentUser();(0,t.useEffect)(()=>{N&&g()},[N]);const g=()=>{if(!N)return;const e=o.getWorkSummary(N.id),a=o.getUserWorkTimes(N.id,10),t=o.getWeeklyData(N.id);s(e),r(a),c(t)},v=e=>e.substring(0,5),w=e=>{const s=Math.floor(e),a=Math.round(60*(e-s));return"".concat(s,"\uc2dc\uac04 ").concat(a,"\ubd84")},y=e=>0===e?"\ubbf8\ub4f1\ub85d":e<4?"\ub2e8\uc2dc\uac04":e<8?"\uc815\uc0c1":"\uc7a5\uc2dc\uac04";return N&&e?(0,l.jsxs)("div",{className:"work-dashboard",children:[(0,l.jsx)("div",{className:"dashboard-header",children:(0,l.jsxs)("div",{className:"header-content",children:[(0,l.jsxs)("div",{className:"header-title",children:[(0,l.jsx)("span",{className:"header-icon",children:"\ud83d\udcca"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:"\uadfc\ubb34 \ub300\uc2dc\ubcf4\ub4dc"}),(0,l.jsxs)("p",{children:[N.name,"\ub2d8\uc758 \uadfc\ubb34 \ud604\ud669"]})]})]}),(0,l.jsxs)("div",{className:"header-actions",children:[(0,l.jsxs)("button",{onClick:()=>j(!0),className:"password-btn",children:[(0,l.jsx)("span",{children:"\ud83d\udd10"}),"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd"]}),(0,l.jsxs)("button",{onClick:g,className:"refresh-btn",children:[(0,l.jsx)("span",{children:"\ud83d\udd04"}),"\uc0c8\ub85c\uace0\uce68"]})]})]})}),(0,l.jsxs)("div",{className:"summary-grid",children:[(0,l.jsxs)("div",{className:"summary-card total",children:[(0,l.jsx)("div",{className:"card-icon",children:"\ud83d\udcc5"}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("div",{className:"card-number",children:e.totalDays}),(0,l.jsx)("div",{className:"card-label",children:"\ucd1d \uadfc\ubb34\uc77c"})]})]}),(0,l.jsxs)("div",{className:"summary-card hours",children:[(0,l.jsx)("div",{className:"card-icon",children:"\u23f0"}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("div",{className:"card-number",children:e.totalHours.toFixed(1)}),(0,l.jsx)("div",{className:"card-label",children:"\ucd1d \uadfc\ubb34\uc2dc\uac04"})]})]}),(0,l.jsxs)("div",{className:"summary-card average",children:[(0,l.jsx)("div",{className:"card-icon",children:"\ud83d\udcc8"}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("div",{className:"card-number",children:e.averageHours.toFixed(1)}),(0,l.jsx)("div",{className:"card-label",children:"\ud3c9\uade0 \uadfc\ubb34\uc2dc\uac04"})]})]}),(0,l.jsxs)("div",{className:"summary-card week",children:[(0,l.jsx)("div",{className:"card-icon",children:"\ud83d\udcc6"}),(0,l.jsxs)("div",{className:"card-content",children:[(0,l.jsx)("div",{className:"card-number",children:e.thisWeekHours.toFixed(1)}),(0,l.jsx)("div",{className:"card-label",children:"\uc774\ubc88 \uc8fc \uadfc\ubb34"})]})]})]}),(0,l.jsxs)("div",{className:"chart-section",children:[(0,l.jsxs)("div",{className:"chart-header",children:[(0,l.jsx)("h2",{children:"\ud83d\udcca \ucd5c\uadfc 7\uc77c \uadfc\ubb34\uc2dc\uac04"}),(0,l.jsx)("p",{children:"\uc77c\ubcc4 \uadfc\ubb34\uc2dc\uac04\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4"})]}),(0,l.jsx)("div",{className:"weekly-chart",children:i.map((e,s)=>{const a=Math.max(...i.map(e=>e.hours),8),t=e.hours>0?Math.max(e.hours/a*100,10):5,r=0===(n=e.hours)?"#e5e7eb":n<4?"#fca5a5":n<8?"#fcd34d":"#34d399";var n;return(0,l.jsxs)("div",{className:"chart-bar",onClick:()=>(e=>{if(!N)return;const s=o.getWorkTimeByDate(N.id,e);m(e),x(s)})(e.date),children:[(0,l.jsx)("div",{className:"bar-container",children:(0,l.jsx)("div",{className:"bar",style:{height:"".concat(t,"%"),backgroundColor:r},children:(0,l.jsx)("div",{className:"bar-value",children:e.hours>0?"".concat(e.hours.toFixed(1),"h"):""})})}),(0,l.jsxs)("div",{className:"bar-label",children:[(0,l.jsx)("div",{className:"day-name",children:e.dayName}),(0,l.jsx)("div",{className:"date",children:e.date.split("-")[2]})]})]},s)})})]}),(0,l.jsxs)("div",{className:"recent-work-section",children:[(0,l.jsxs)("div",{className:"section-header",children:[(0,l.jsx)("h2",{children:"\ud83d\udccb \ucd5c\uadfc \uadfc\ubb34 \uae30\ub85d"}),(0,l.jsx)("p",{children:"\ucd5c\uadfc 10\uc77c\uac04\uc758 \uadfc\ubb34 \uae30\ub85d\uc785\ub2c8\ub2e4"})]}),(0,l.jsx)("div",{className:"work-records",children:0===a.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\ud83d\udced"}),(0,l.jsx)("h3",{children:"\ub4f1\ub85d\ub41c \uadfc\ubb34 \uae30\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,l.jsx)("p",{children:"\uadfc\ubb34\uc2dc\uac04\uc744 \uc785\ub825\ud558\uc5ec \uae30\ub85d\uc744 \uc2dc\uc791\ud574\ubcf4\uc138\uc694"})]}):a.map(e=>(0,l.jsxs)("div",{className:"work-record-card",onClick:()=>{m(e.date),x(e)},children:[(0,l.jsxs)("div",{className:"record-header",children:[(0,l.jsxs)("div",{className:"record-date",children:[(0,l.jsx)("span",{className:"date-icon",children:"\ud83d\udcc5"}),new Date(e.date).toLocaleDateString("ko-KR",{month:"2-digit",day:"2-digit",weekday:"short"})]}),(0,l.jsx)("div",{className:"work-status ".concat(y(e.totalHours).toLowerCase()),children:y(e.totalHours)})]}),(0,l.jsxs)("div",{className:"record-content",children:[(0,l.jsxs)("div",{className:"time-info",children:[(0,l.jsxs)("span",{className:"time-range",children:[v(e.startTime)," ~ ",v(e.endTime)]}),(0,l.jsxs)("span",{className:"break-time",children:["(\ud734\uac8c ",e.breakTime,"\ubd84)"]})]}),(0,l.jsx)("div",{className:"total-hours",children:w(e.totalHours)})]}),e.notes&&(0,l.jsxs)("div",{className:"record-notes",children:[(0,l.jsx)("span",{className:"notes-icon",children:"\ud83d\udcdd"}),e.notes]})]},e.id))})]}),d&&(0,l.jsx)("div",{className:"work-detail-modal",onClick:()=>m(null),children:(0,l.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsxs)("h3",{children:[new Date(d).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"long"})," \uadfc\ubb34 \uc0c1\uc138"]}),(0,l.jsx)("button",{className:"modal-close",onClick:()=>m(null),children:"\xd7"})]}),(0,l.jsx)("div",{className:"modal-body",children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\u23f0 \uadfc\ubb34 \uc2dc\uac04"}),(0,l.jsxs)("div",{className:"detail-content",children:[(0,l.jsxs)("div",{className:"time-detail",children:[(0,l.jsx)("span",{className:"label",children:"\uc2dc\uc791:"}),(0,l.jsx)("span",{className:"value",children:v(u.startTime)})]}),(0,l.jsxs)("div",{className:"time-detail",children:[(0,l.jsx)("span",{className:"label",children:"\uc885\ub8cc:"}),(0,l.jsx)("span",{className:"value",children:v(u.endTime)})]}),(0,l.jsxs)("div",{className:"time-detail",children:[(0,l.jsx)("span",{className:"label",children:"\ud734\uac8c\uc2dc\uac04:"}),(0,l.jsxs)("span",{className:"value",children:[u.breakTime,"\ubd84"]})]}),(0,l.jsxs)("div",{className:"time-detail total",children:[(0,l.jsx)("span",{className:"label",children:"\ucd1d \uadfc\ubb34\uc2dc\uac04:"}),(0,l.jsx)("span",{className:"value",children:w(u.totalHours)})]})]})]}),u.notes&&(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83d\udcdd \uba54\ubaa8"}),(0,l.jsx)("div",{className:"detail-content",children:(0,l.jsx)("p",{className:"notes-content",children:u.notes})})]}),(0,l.jsxs)("div",{className:"detail-section",children:[(0,l.jsx)("h4",{children:"\ud83d\udcca \uc0c1\ud0dc"}),(0,l.jsx)("div",{className:"detail-content",children:(0,l.jsx)("div",{className:"status-badge ".concat(y(u.totalHours).toLowerCase()),children:y(u.totalHours)})})]})]}):(0,l.jsxs)("div",{className:"no-work-data",children:[(0,l.jsx)("div",{className:"no-data-icon",children:"\ud83d\udced"}),(0,l.jsx)("h4",{children:"\ud574\ub2f9 \ub0a0\uc9dc\uc5d0 \ub4f1\ub85d\ub41c \uadfc\ubb34 \uae30\ub85d\uc774 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,l.jsx)("p",{children:"\uadfc\ubb34\uc2dc\uac04 \uc785\ub825 \ud398\uc774\uc9c0\uc5d0\uc11c \uae30\ub85d\uc744 \ucd94\uac00\ud574\ubcf4\uc138\uc694"})]})})]})}),(0,l.jsx)(h,{isOpen:p,userId:(null===N||void 0===N?void 0:N.id)||"0",onClose:()=>j(!1),onSuccess:()=>{}})]}):(0,l.jsx)("div",{className:"work-dashboard loading",children:(0,l.jsxs)("div",{className:"loading-content",children:[(0,l.jsx)("div",{className:"loading-spinner",children:"\u27f3"}),(0,l.jsx)("p",{children:"\ub300\uc2dc\ubcf4\ub4dc\ub97c \ubd88\ub7ec\uc624\ub294 \uc911..."})]})})},u=()=>{const[e,s]=(0,t.useState)((new Date).toISOString().split("T")[0]),[a,r]=(0,t.useState)("09:00"),[i,c]=(0,t.useState)("18:00"),[d,h]=(0,t.useState)(60),[m,u]=(0,t.useState)(""),[x,p]=(0,t.useState)(!1),[j,N]=(0,t.useState)(null),[g,v]=(0,t.useState)({show:!1,message:"",type:"success"}),w=n.getCurrentUser();(0,t.useEffect)(()=>{w&&y()},[e,w]);const y=()=>{if(!w)return;const s=o.getWorkTimeByDate(w.id,e);s?(N(s),r(s.startTime),c(s.endTime),h(s.breakTime),u(s.notes||"")):(N(null),r("09:00"),c("18:00"),h(60),u(""))},f=(e,s)=>{v({show:!0,message:e,type:s}),setTimeout(()=>{v({show:!1,message:"",type:"success"})},3e3)},b=(e,s,a)=>{r("".concat(e.toString().padStart(2,"0"),":00")),c("".concat(s.toString().padStart(2,"0"),":00")),h(a)},_=((e,s,a)=>{const[t,r]=e.split(":").map(Number),[i,n]=s.split(":").map(Number),l=60*t+r;let c=60*i+n;c<l&&(c+=1440);const o=c-l-a;return Math.max(0,o/60)})(a,i,d),S=_>0&&_<=24;return(0,l.jsxs)("div",{className:"work-time-input",children:[(0,l.jsxs)("div",{className:"input-header",children:[(0,l.jsxs)("div",{className:"input-title",children:[(0,l.jsx)("span",{className:"input-icon",children:"\u23f0"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{children:"\uadfc\ubb34\uc2dc\uac04 \uc785\ub825"}),(0,l.jsx)("p",{children:"\uc815\ud655\ud55c \uadfc\ubb34\uc2dc\uac04\uc744 \uae30\ub85d\ud574\uc8fc\uc138\uc694"})]})]}),j&&(0,l.jsxs)("div",{className:"edit-indicator",children:[(0,l.jsx)("span",{className:"edit-icon",children:"\u270f\ufe0f"}),(0,l.jsx)("span",{children:"\uc218\uc815 \ubaa8\ub4dc"})]})]}),(0,l.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),w){p(!0);try{const t=o.addWorkTime(w.id,e,a,i,d,m.trim()||void 0);if(f("\uadfc\ubb34\uc2dc\uac04\uc774 \uc131\uacf5\uc801\uc73c\ub85c ".concat(j?"\uc218\uc815":"\ub4f1\ub85d","\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),"success"),N(t),!j){const a=new Date(e);a.setDate(a.getDate()+1);const t=a.toISOString().split("T")[0];t<=(new Date).toISOString().split("T")[0]&&s(t)}}catch(r){f("\uadfc\ubb34\uc2dc\uac04 \uc800\uc7a5\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.","error"),console.error(r)}finally{p(!1)}}else f("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.","error")},className:"work-form",children:[(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h3",{className:"section-title",children:"\ud83d\udcc5 \uae30\ubcf8 \uc815\ubcf4"}),(0,l.jsx)("div",{className:"form-row",children:(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"date",className:"form-label",children:"\ub0a0\uc9dc"}),(0,l.jsx)("input",{id:"date",type:"date",value:e,onChange:e=>s(e.target.value),max:(new Date).toISOString().split("T")[0],className:"form-input",required:!0})]})})]}),(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h3",{className:"section-title",children:"\ud83d\udd50 \uadfc\ubb34\uc2dc\uac04"}),(0,l.jsxs)("div",{className:"quick-times",children:[(0,l.jsx)("div",{className:"quick-times-header",children:"\ube60\ub978 \uc124\uc815"}),(0,l.jsxs)("div",{className:"quick-time-buttons",children:[(0,l.jsx)("button",{type:"button",className:"quick-time-btn",onClick:()=>b(9,18,60),children:"09:00-18:00 (1\uc2dc\uac04 \ud734\uac8c)"}),(0,l.jsx)("button",{type:"button",className:"quick-time-btn",onClick:()=>b(10,19,60),children:"10:00-19:00 (1\uc2dc\uac04 \ud734\uac8c)"}),(0,l.jsx)("button",{type:"button",className:"quick-time-btn",onClick:()=>b(14,22,30),children:"14:00-22:00 (30\ubd84 \ud734\uac8c)"})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"startTime",className:"form-label",children:"\uc2dc\uc791 \uc2dc\uac04"}),(0,l.jsx)("input",{id:"startTime",type:"time",value:a,onChange:e=>r(e.target.value),className:"form-input",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"endTime",className:"form-label",children:"\uc885\ub8cc \uc2dc\uac04"}),(0,l.jsx)("input",{id:"endTime",type:"time",value:i,onChange:e=>c(e.target.value),className:"form-input",required:!0})]})]}),(0,l.jsxs)("div",{className:"form-row",children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"breakTime",className:"form-label",children:"\ud734\uac8c\uc2dc\uac04 (\ubd84)"}),(0,l.jsxs)("select",{id:"breakTime",value:d,onChange:e=>h(Number(e.target.value)),className:"form-input",required:!0,children:[(0,l.jsx)("option",{value:0,children:"0\ubd84"}),(0,l.jsx)("option",{value:30,children:"30\ubd84"}),(0,l.jsx)("option",{value:60,children:"1\uc2dc\uac04"}),(0,l.jsx)("option",{value:90,children:"1\uc2dc\uac04 30\ubd84"}),(0,l.jsx)("option",{value:120,children:"2\uc2dc\uac04"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{className:"form-label",children:"\ucd1d \uadfc\ubb34\uc2dc\uac04"}),(0,l.jsx)("div",{className:"work-hours-display ".concat(S?"":"invalid"),children:S?"".concat(_.toFixed(1),"\uc2dc\uac04"):"\uc798\ubabb\ub41c \uc2dc\uac04"})]})]})]}),(0,l.jsxs)("div",{className:"form-section",children:[(0,l.jsx)("h3",{className:"section-title",children:"\ud83d\udcdd \uba54\ubaa8"}),(0,l.jsx)("div",{className:"form-group",children:(0,l.jsx)("textarea",{id:"notes",value:m,onChange:e=>u(e.target.value),placeholder:"\ud2b9\uc774\uc0ac\ud56d, \uc5c5\ubb34 \ub0b4\uc6a9 \ub4f1\uc744 \uae30\ub85d\ud574\uc8fc\uc138\uc694 (\uc120\ud0dd\uc0ac\ud56d)",className:"form-textarea",rows:3})})]}),(0,l.jsx)("div",{className:"form-actions",children:(0,l.jsx)("button",{type:"submit",className:"submit-btn ".concat(S?"":"disabled"),disabled:x||!S,children:x?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"loading-icon",children:"\u27f3"}),"\uc800\uc7a5 \uc911..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"submit-icon",children:"\ud83d\udcbe"}),j?"\uc218\uc815\ud558\uae30":"\ub4f1\ub85d\ud558\uae30"]})})})]}),g.show&&(0,l.jsxs)("div",{className:"work-toast ".concat(g.type),children:[(0,l.jsx)("span",{className:"toast-icon",children:"success"===g.type?"\u2705":"\u274c"}),(0,l.jsx)("span",{className:"toast-message",children:g.message})]})]})},x=()=>{const[e,s]=(0,t.useState)(!1),[a,r]=(0,t.useState)(null),[i,o]=(0,t.useState)("dashboard"),[d,h]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(()=>{const e=n.isAuthenticated(),a=n.getCurrentUser();s(e),r(a),h(!1)})();const a=setInterval(()=>{const a=n.isAuthenticated(),t=n.getCurrentUser();a!==e&&(s(a),r(t))},6e4);return()=>clearInterval(a)},[e]);const x=()=>{const e=n.getCurrentUser();s(!0),r(e)};return d?(0,l.jsx)("div",{className:"user-app-loading",children:(0,l.jsxs)("div",{className:"loading-content",children:[(0,l.jsx)("div",{className:"loading-icon",children:"\u2699\ufe0f"}),(0,l.jsx)("div",{className:"loading-text",children:"\uadfc\ubb34\uc2dc\uac04 \uad00\ub9ac \uc2dc\uc2a4\ud15c \uc2dc\uc791 \uc911..."})]})}):e&&a?(0,l.jsxs)("div",{className:"user-app",children:[(0,l.jsxs)("nav",{className:"user-nav",children:[(0,l.jsx)("div",{className:"nav-header",children:(0,l.jsxs)("div",{className:"brand",children:[(0,l.jsx)("div",{className:"brand-icon",children:"\u23f0"}),(0,l.jsxs)("div",{className:"brand-content",children:[(0,l.jsx)("h1",{className:"brand-title",children:"\uadfc\ubb34\uc2dc\uac04 \uad00\ub9ac"}),(0,l.jsx)("p",{className:"brand-subtitle",children:"Work Time Tracker"})]})]})}),(0,l.jsx)("div",{className:"nav-menu",children:(0,l.jsxs)("div",{className:"menu-section",children:[(0,l.jsx)("div",{className:"menu-label",children:"\uba54\uc778 \uba54\ub274"}),(0,l.jsxs)("button",{className:"nav-item ".concat("dashboard"===i?"active":""),onClick:()=>o("dashboard"),children:[(0,l.jsx)("span",{className:"nav-icon",children:"\ud83d\udcca"}),(0,l.jsx)("span",{className:"nav-text",children:"\ub300\uc2dc\ubcf4\ub4dc"})]}),(0,l.jsxs)("button",{className:"nav-item ".concat("input"===i?"active":""),onClick:()=>o("input"),children:[(0,l.jsx)("span",{className:"nav-icon",children:"\u23f0"}),(0,l.jsx)("span",{className:"nav-text",children:"\uadfc\ubb34\uc2dc\uac04 \uc785\ub825"})]})]})}),(0,l.jsxs)("div",{className:"nav-footer",children:[(0,l.jsxs)("div",{className:"user-info",children:[(0,l.jsxs)("div",{className:"user-details",children:[(0,l.jsx)("div",{className:"user-avatar",children:"\ud83d\udc64"}),(0,l.jsxs)("div",{className:"user-text",children:[(0,l.jsx)("span",{className:"user-name",children:a.name}),(0,l.jsx)("span",{className:"user-email",children:a.email}),(0,l.jsxs)("span",{className:"login-time",children:["\ub85c\uadf8\uc778: ",new Date(a.loginTime).toLocaleString("ko-KR",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]})]})]}),(0,l.jsx)("button",{className:"logout-btn",onClick:()=>{window.confirm("\uc815\ub9d0 \ub85c\uadf8\uc544\uc6c3\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&(n.logout(),s(!1),r(null),o("dashboard"))},title:"\ub85c\uadf8\uc544\uc6c3",children:"\ud83d\udeaa"})]}),(0,l.jsxs)("div",{className:"version-info",children:[(0,l.jsx)("span",{className:"version-text",children:"v1.0.0"}),(0,l.jsx)("span",{className:"company",children:"\xa9 Work Tracker"})]})]})]}),(0,l.jsx)("main",{className:"user-main",children:(()=>{switch(i){case"dashboard":default:return(0,l.jsx)(m,{});case"input":return(0,l.jsx)(u,{})}})()})]}):(0,l.jsx)(c,{onLoginSuccess:x})}},4161:(e,s,a)=>{a.d(s,{D:()=>n});var t=a(2555),r=a(7800),i=a(1334);class n{static async getAllUsers(){try{const{data:e,error:s}=await r.N.from(this.tableName).select("*").order("created_at",{ascending:!1});if(s)throw s;return e||[]}catch(e){return console.error("Error getting all users:",e),[]}}static async getUserById(e){try{const{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("id",e).single();if(a)throw a;return s}catch(s){return console.error("Error getting user by ID:",s),null}}static async createUser(e){var s;let a=null,n=null,l=!1;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(n=i.h.generateTempPassword(),a=await i.h.hashPassword(n),l=!0);const c=(0,t.A)((0,t.A)({},e),{},{password_hash:a,password_temp:n,is_password_temp:l,is_active:null===(s=e.is_active)||void 0===s||s,hourly_wage:e.hourly_wage||0,monthly_salary:e.monthly_salary||0,salary_type:e.salary_type||"HOURLY"});try{const{data:e,error:s}=await r.N.from(this.tableName).insert(c).select().single();if(s){if("23505"===s.code)throw new Error("\uc774\ubbf8 \uc874\uc7ac\ud558\ub294 \uc0ac\uc6a9\uc790\uc785\ub2c8\ub2e4.");throw s}return(0,t.A)((0,t.A)({},e),{},{password_temp:n})}catch(o){throw console.error("Error creating user:",o),o}}static async updateUser(e,s){try{const{data:a,error:t}=await r.N.from(this.tableName).update(s).eq("id",e).select().single();if(t)throw t;return a}catch(a){throw console.error("Error updating user:",a),a}}static async deleteUser(e){try{const{error:s}=await r.N.from(this.tableName).delete().eq("id",e);if(s)throw s;return!0}catch(s){return console.error("Error deleting user:",s),!1}}static async getUsersWithCurrentSchedule(){try{const e=this.getCurrentWeekStart(),{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("is_active",!0);if(a)throw a;const t=[];for(const i of s||[]){const s=i,{data:a}=await r.N.from("work_schedules").select("*").eq("user_id",i.id).eq("week_start_date",e);if(a&&a.length>0){const t=a[0];s.current_schedule={user_id:i.id,week_start_date:e,monday_start:t.monday_start,monday_end:t.monday_end,tuesday_start:t.tuesday_start,tuesday_end:t.tuesday_end,wednesday_start:t.wednesday_start,wednesday_end:t.wednesday_end,thursday_start:t.thursday_start,thursday_end:t.thursday_end,friday_start:t.friday_start,friday_end:t.friday_end,saturday_start:t.saturday_start,saturday_end:t.saturday_end,sunday_start:t.sunday_start,sunday_end:t.sunday_end}}const n=await this.getUserWeeklyHours(i.id,e);s.total_hours_this_week=n.total_hours,s.total_pay_this_week=n.total_pay,t.push(s)}return t.sort((e,s)=>e.full_name.localeCompare(s.full_name))}catch(e){return console.error("Error getting users with current schedule:",e),[]}}static getCurrentWeekStart(){const e=new Date,s=e.getDay(),a=e.getDate()-s+(0===s?-6:1);return new Date(e.setDate(a)).toISOString().split("T")[0]}static async getUserWeeklyHours(e,s){try{const a=new Date(s);a.setDate(a.getDate()+6);const t=a.toISOString().split("T")[0],{data:i}=await r.N.from("work_records").select("*").eq("user_id",e).gte("work_date",s).lte("work_date",t),n=(i||[]).reduce((e,s)=>e+(s.total_hours||0),0);return{total_hours:n,total_pay:(i||[]).reduce((e,s)=>e+(s.total_pay||0),0)}}catch(a){return console.error("Error getting user weekly hours:",a),{total_hours:0,total_pay:0}}}static async getUserByEmail(e){try{const{data:s,error:a}=await r.N.from(this.tableName).select("*").eq("email",e).eq("is_active",!0).single();if(a)throw a;return s}catch(s){return console.error("Error getting user by email:",s),null}}static async authenticateUser(e,s){const a=await this.getUserByEmail(e);if(!a||!a.password_hash)return null;return await i.h.verifyPassword(s,a.password_hash)?(await this.updateLastLogin(a.id),a):null}static async updateLastLogin(e){try{const{error:s}=await r.N.from(this.tableName).update({last_login:(new Date).toISOString()}).eq("id",e);if(s)throw s}catch(s){console.error("Error updating last login:",s)}}static async resetPassword(e){const s=i.h.generateTempPassword(),a=await i.h.hashPassword(s);try{const{error:t}=await r.N.from(this.tableName).update({password_hash:a,password_temp:s,is_password_temp:!0}).eq("id",e);if(t)throw t;return s}catch(t){throw console.error("Error resetting password:",t),t}}static async changePassword(e,s){const a=i.h.validatePassword(s);if(!a.valid)throw new Error(a.errors.join(", "));const t=await i.h.hashPassword(s);try{const{error:s}=await r.N.from(this.tableName).update({password_hash:t,password_temp:null,is_password_temp:!1}).eq("id",e);if(s)throw s;return!0}catch(n){throw console.error("Error changing password:",n),n}}static async toggleUserLoginAccess(e,s){try{if(s){const s=i.h.generateTempPassword(),a=await i.h.hashPassword(s),{error:t}=await r.N.from(this.tableName).update({password_hash:a,password_temp:s,is_password_temp:!0}).eq("id",e);if(t)throw t}else{const{error:s}=await r.N.from(this.tableName).update({password_hash:null,password_temp:null,is_password_temp:!0}).eq("id",e);if(s)throw s}}catch(a){throw console.error("Error toggling user login access:",a),a}}}n.tableName="users"}}]);
//# sourceMappingURL=180.a71a9e98.chunk.js.map