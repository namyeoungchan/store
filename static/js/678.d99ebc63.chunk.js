"use strict";(self.webpackChunkstore_inventory_system=self.webpackChunkstore_inventory_system||[]).push([[678],{8678:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});var i=t(2555),a=t(5043),r=t(4241),o=t(52),s=t(2408),c=t(152),d=t(579);const l=n=>{let{onOrderComplete:e}=n;const[t,l]=(0,a.useState)([]),[m,p]=(0,a.useState)([]),[u,g]=(0,a.useState)(!1),[f,b]=(0,a.useState)(""),[h,x]=(0,a.useState)(""),[y,v]=(0,a.useState)({}),[j,w]=(0,a.useState)({}),[N,k]=(0,a.useState)("CARD"),_=(0,a.useCallback)(async()=>{try{const n=await r.$.getAllMenus();l(n);const e={};for(const t of n)t.id&&(e[t.id]=await r.$.getRecipesByMenuId(t.id));v(e)}catch(n){b("\uba54\ub274\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}},[]),q=(0,a.useCallback)(async()=>{const n={};for(const i of t){var e;if(!i.id)continue;const t=y[i.id]||[];if(0===t.length){n[i.id]={available:!1,reason:"\uc7ac\ub8cc\uac00 \uc124\uc815\ub418\uc9c0 \uc54a\uc74c"};continue}const a=(null===(e=m.find(n=>n.menu_id===i.id))||void 0===e?void 0:e.quantity)||0;let r=!0,o="",c=1/0;for(const e of t){const t=await s.c.getInventoryByIngredientId(e.ingredient_id);if(!t){n[i.id]={available:!1,reason:"\uc7ac\uace0 \uc815\ubcf4 \uc5c6\uc74c: ".concat(e.ingredient_name)},r=!1;break}const d=e.quantity,l=d*a,m=t.current_stock-l,p=Math.floor(m/d);if(p<1){n[i.id]={available:!1,reason:"\uc7ac\uace0 \ubd80\uc871: ".concat(e.ingredient_name," (\ud544\uc694: ").concat(d,", \uc7ac\uace0: ").concat(m,")")},r=!1;break}p<c&&(c=p,o=e.ingredient_name)}r&&(n[i.id]={available:!0,reason:c===1/0?"":"\ucd5c\ub300 ".concat(c,"\uac1c \uc8fc\ubb38 \uac00\ub2a5 (").concat(o," \uc81c\ud55c)")})}w(n)},[t,y,m]);(0,a.useEffect)(()=>{_()},[]),(0,a.useEffect)(()=>{q()},[t,m,y]);const z=(n,e)=>{e<=0?S(n):p(m.map(t=>t.menu_id===n?(0,i.A)((0,i.A)({},t),{},{quantity:e}):t))},S=n=>{p(m.filter(e=>e.menu_id!==n))},C=()=>m.reduce((n,e)=>n+e.unit_price*e.quantity,0);return(0,d.jsxs)("div",{className:"order-system",children:[(0,d.jsxs)("div",{className:"order-header",children:[(0,d.jsx)("h2",{children:"\ud83c\udf7d\ufe0f \uc8fc\ubb38 \uc2dc\uc2a4\ud15c"}),f&&(0,d.jsx)("div",{className:"alert alert-error",children:f}),h&&(0,d.jsx)("div",{className:"alert alert-success",children:h})]}),(0,d.jsxs)("div",{className:"order-content",children:[(0,d.jsxs)("div",{className:"menu-section",children:[(0,d.jsx)("h3",{children:"\uba54\ub274 \uc120\ud0dd"}),(0,d.jsx)("div",{className:"menu-grid",children:t.map(n=>{const e=j[n.id],t=null===e||void 0===e?void 0:e.available,a=m.find(e=>e.menu_id===n.id);return(0,d.jsxs)("div",{className:"menu-card ".concat(t?"":"unavailable"),children:[(0,d.jsxs)("div",{className:"menu-info",children:[(0,d.jsx)("h4",{children:n.name}),(0,d.jsx)("p",{className:"menu-description",children:n.description}),(0,d.jsxs)("p",{className:"menu-price",children:["\u20a9",n.price.toLocaleString()]}),(0,d.jsxs)("div",{className:"stock-status",children:[e?(0,d.jsx)("div",{className:"status-badge ".concat(t?"available":"unavailable"),children:t?"\u2705 \uc8fc\ubb38 \uac00\ub2a5":"\u274c \uc8fc\ubb38 \ubd88\uac00"}):(0,d.jsx)("div",{className:"status-badge loading",children:"\ud83d\udccb \ud655\uc778 \uc911..."}),(null===e||void 0===e?void 0:e.reason)&&(0,d.jsx)("p",{className:"availability-reason",children:e.reason}),a&&(0,d.jsxs)("p",{className:"cart-info",children:["\uc7a5\ubc14\uad6c\ub2c8\uc5d0 ",a.quantity,"\uac1c"]})]}),y[n.id]&&y[n.id].length>0&&(0,d.jsxs)("div",{className:"recipe-preview",children:[(0,d.jsx)("p",{className:"recipe-title",children:"\ud83d\udcdd \ud544\uc694 \uc7ac\ub8cc:"}),(0,d.jsx)("div",{className:"recipe-ingredients",children:y[n.id].map(n=>(0,d.jsxs)("span",{className:"ingredient-tag",children:[n.ingredient_name," ",n.quantity,n.ingredient_unit]},n.id))})]})]}),(0,d.jsx)("button",{className:"btn btn-primary",onClick:()=>(n=>{if(!n.id)return;const e=j[n.id];if(null===e||void 0===e||!e.available)return b((null===e||void 0===e?void 0:e.reason)||"\uc774 \uba54\ub274\ub294 \ud604\uc7ac \uc8fc\ubb38\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),void setTimeout(()=>b(""),3e3);if(m.find(e=>e.menu_id===n.id))p(m.map(e=>e.menu_id===n.id?(0,i.A)((0,i.A)({},e),{},{quantity:e.quantity+1}):e));else{const e={id:Date.now().toString(),order_id:"0",menu_id:n.id,quantity:1,unit_price:n.price,menu_name:n.name,price:n.price};p([...m,e])}x("".concat(n.name,"\uc774(\uac00) \uc8fc\ubb38\uc5d0 \ucd94\uac00\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")),setTimeout(()=>x(""),2e3)})(n),disabled:u||!t,children:t?"\ucd94\uac00":"\uc8fc\ubb38 \ubd88\uac00"})]},n.id)})})]}),(0,d.jsxs)("div",{className:"cart-section",children:[(0,d.jsxs)("div",{className:"cart-header",children:[(0,d.jsxs)("h3",{children:["\uc8fc\ubb38 \ub0b4\uc5ed (",m.length,")"]}),m.length>0&&(0,d.jsx)("button",{className:"btn btn-secondary btn-small",onClick:()=>{window.confirm("\uc7a5\ubc14\uad6c\ub2c8\ub97c \ube44\uc6b0\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&p([])},children:"\uc804\uccb4 \uc0ad\uc81c"})]}),0===m.length?(0,d.jsx)("div",{className:"empty-cart",children:(0,d.jsx)("p",{children:"\uc120\ud0dd\ub41c \uba54\ub274\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."})}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"cart-items",children:m.map(n=>(0,d.jsxs)("div",{className:"cart-item",children:[(0,d.jsxs)("div",{className:"item-info",children:[(0,d.jsx)("h4",{children:n.menu_name}),(0,d.jsxs)("p",{children:["\u20a9",n.unit_price.toLocaleString()," \xd7 ",n.quantity]})]}),(0,d.jsxs)("div",{className:"item-controls",children:[(0,d.jsxs)("div",{className:"quantity-controls",children:[(0,d.jsx)("button",{className:"btn btn-small",onClick:()=>z(n.menu_id,n.quantity-1),children:"-"}),(0,d.jsx)("span",{className:"quantity",children:n.quantity}),(0,d.jsx)("button",{className:"btn btn-small",onClick:()=>z(n.menu_id,n.quantity+1),children:"+"})]}),(0,d.jsx)("button",{className:"btn btn-danger btn-small",onClick:()=>S(n.menu_id),children:"\uc0ad\uc81c"})]}),(0,d.jsxs)("div",{className:"item-total",children:["\u20a9",(n.unit_price*n.quantity).toLocaleString()]})]},n.id))}),(0,d.jsxs)("div",{className:"cart-summary",children:[(0,d.jsxs)("div",{className:"payment-type-section",children:[(0,d.jsx)("h4",{children:"\uacb0\uc81c \ubc29\ubc95"}),(0,d.jsx)("div",{className:"payment-options",children:["CARD","COUPANG","BAEMIN","YOGIYO"].map(n=>(0,d.jsxs)("label",{className:"payment-option",children:[(0,d.jsx)("input",{type:"radio",name:"paymentType",value:n,checked:N===n,onChange:n=>k(n.target.value)}),(0,d.jsxs)("span",{className:"payment-label",children:[c.w.getPaymentTypeIcon(n)," ",c.w.getPaymentTypeDisplayName(n)]})]},n))}),(0,d.jsx)("div",{className:"deposit-info",children:(0,d.jsxs)("p",{children:["\ud83d\udcc5 \uc785\uae08 \uc608\uc815\uc77c: ",c.w.calculateExpectedDepositDate((new Date).toISOString(),N)]})})]}),(0,d.jsx)("div",{className:"total-amount",children:(0,d.jsxs)("strong",{children:["\ucd1d \uae08\uc561: \u20a9",C().toLocaleString()]})}),(0,d.jsx)("button",{className:"btn btn-success btn-large",onClick:async()=>{if(0!==m.length){g(!0),b("");try{const n=C(),t="\n\uc8fc\ubb38 \ub0b4\uc5ed:\n".concat(m.map(n=>"\u2022 ".concat(n.menu_name," x").concat(n.quantity," = \u20a9").concat((n.unit_price*n.quantity).toLocaleString())).join("\n"),"\n\n\ucd1d \uae08\uc561: \u20a9").concat(n.toLocaleString(),"\n\n\uc8fc\ubb38\uc744 \uc9c4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?");if(!window.confirm(t))return void g(!1);const i=m.map(n=>({menu_id:n.menu_id,quantity:n.quantity,unit_price:n.unit_price})),a=await o.Q.createOrderWithItems(i,N);if(x("\uc8fc\ubb38\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4!"),p([]),e){const n=await o.Q.getOrderById(a);n&&e(n)}}catch(n){b(n instanceof Error?n.message:"\uc8fc\ubb38 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}finally{g(!1)}}else b("\uc8fc\ubb38\ud560 \uba54\ub274\ub97c \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},disabled:u||0===m.length,children:u?"\ucc98\ub9ac\uc911...":"\uc8fc\ubb38\ud558\uae30"})]})]})]})]}),(0,d.jsx)("style",{children:'\n        .order-system {\n          max-width: 1200px;\n          margin: 0 auto;\n          padding: 2rem;\n        }\n\n        .order-header {\n          margin-bottom: 2rem;\n        }\n\n        .order-header h2 {\n          margin: 0 0 1rem 0;\n          color: #333;\n        }\n\n        .alert {\n          padding: 0.75rem 1rem;\n          border-radius: 4px;\n          margin-bottom: 1rem;\n        }\n\n        .alert-error {\n          background-color: #ffeaea;\n          color: #d32f2f;\n          border: 1px solid #ffcdd2;\n        }\n\n        .alert-success {\n          background-color: #e8f5e8;\n          color: #4caf50;\n          border: 1px solid #c8e6c9;\n        }\n\n        .order-content {\n          display: grid;\n          grid-template-columns: 2fr 1fr;\n          gap: 2rem;\n        }\n\n        .menu-section h3, .cart-section h3 {\n          margin: 0 0 1rem 0;\n          color: #333;\n        }\n\n        .menu-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n          gap: 1rem;\n        }\n\n        .menu-card {\n          background: white;\n          border: 1px solid #ddd;\n          border-radius: 8px;\n          padding: 1.5rem;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          transition: transform 0.2s, box-shadow 0.2s;\n        }\n\n        .menu-card:hover {\n          transform: translateY(-2px);\n          box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        }\n\n        .menu-card.unavailable {\n          opacity: 0.7;\n          background: #f5f5f5;\n        }\n\n        .menu-card.unavailable:hover {\n          transform: none;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n\n        .menu-info h4 {\n          margin: 0 0 0.5rem 0;\n          color: #333;\n          font-size: 1.1rem;\n        }\n\n        .menu-description {\n          color: #666;\n          font-size: 0.9rem;\n          margin: 0 0 1rem 0;\n          line-height: 1.4;\n        }\n\n        .menu-price {\n          font-size: 1.2rem;\n          font-weight: bold;\n          color: #2196f3;\n          margin: 0 0 1rem 0;\n        }\n\n        .stock-status {\n          margin: 1rem 0;\n        }\n\n        .status-badge {\n          display: inline-block;\n          padding: 0.25rem 0.5rem;\n          border-radius: 4px;\n          font-size: 0.8rem;\n          font-weight: 500;\n          margin-bottom: 0.5rem;\n        }\n\n        .status-badge.available {\n          background: #e8f5e8;\n          color: #4caf50;\n          border: 1px solid #4caf50;\n        }\n\n        .status-badge.unavailable {\n          background: #ffebee;\n          color: #f44336;\n          border: 1px solid #f44336;\n        }\n\n        .status-badge.loading {\n          background: #fff3e0;\n          color: #ff9800;\n          border: 1px solid #ff9800;\n        }\n\n        .availability-reason {\n          font-size: 0.75rem;\n          color: #666;\n          margin: 0;\n          line-height: 1.3;\n        }\n\n        .cart-info {\n          font-size: 0.75rem;\n          color: #2196f3;\n          font-weight: 500;\n          margin: 0.25rem 0 0 0;\n        }\n\n        .recipe-preview {\n          margin-top: 1rem;\n          padding-top: 1rem;\n          border-top: 1px solid #eee;\n        }\n\n        .recipe-title {\n          font-size: 0.8rem;\n          font-weight: 600;\n          color: #333;\n          margin: 0 0 0.5rem 0;\n        }\n\n        .recipe-ingredients {\n          display: flex;\n          flex-wrap: wrap;\n          gap: 0.25rem;\n        }\n\n        .ingredient-tag {\n          background: #f0f0f0;\n          color: #555;\n          padding: 0.2rem 0.4rem;\n          border-radius: 3px;\n          font-size: 0.7rem;\n          font-weight: 500;\n        }\n\n        .cart-section {\n          background: white;\n          border-radius: 8px;\n          padding: 1.5rem;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n          height: fit-content;\n          position: sticky;\n          top: 2rem;\n        }\n\n        .cart-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 1rem;\n        }\n\n        .empty-cart {\n          text-align: center;\n          padding: 2rem;\n          color: #999;\n        }\n\n        .cart-item {\n          display: grid;\n          grid-template-columns: 1fr auto auto;\n          gap: 1rem;\n          align-items: center;\n          padding: 1rem 0;\n          border-bottom: 1px solid #eee;\n        }\n\n        .cart-item:last-child {\n          border-bottom: none;\n        }\n\n        .item-info h4 {\n          margin: 0 0 0.25rem 0;\n          font-size: 0.95rem;\n        }\n\n        .item-info p {\n          margin: 0;\n          color: #666;\n          font-size: 0.85rem;\n        }\n\n        .item-controls {\n          display: flex;\n          flex-direction: column;\n          gap: 0.5rem;\n          align-items: center;\n        }\n\n        .quantity-controls {\n          display: flex;\n          align-items: center;\n          gap: 0.5rem;\n        }\n\n        .quantity {\n          min-width: 2rem;\n          text-align: center;\n          font-weight: bold;\n        }\n\n        .item-total {\n          font-weight: bold;\n          color: #2196f3;\n          text-align: right;\n        }\n\n        .cart-summary {\n          margin-top: 1rem;\n          padding-top: 1rem;\n          border-top: 2px solid #eee;\n        }\n\n        .payment-type-section {\n          margin-bottom: 1.5rem;\n        }\n\n        .payment-type-section h4 {\n          margin: 0 0 1rem 0;\n          color: #333;\n          font-size: 1rem;\n        }\n\n        .payment-options {\n          display: flex;\n          flex-direction: column;\n          gap: 0.5rem;\n        }\n\n        .payment-option {\n          display: flex;\n          align-items: center;\n          padding: 0.75rem;\n          border: 2px solid #e2e8f0;\n          border-radius: 8px;\n          cursor: pointer;\n          transition: all 0.2s;\n        }\n\n        .payment-option:hover {\n          border-color: #2196f3;\n          background: #f8faff;\n        }\n\n        .payment-option input[type="radio"] {\n          margin-right: 0.75rem;\n          transform: scale(1.2);\n        }\n\n        .payment-option input[type="radio"]:checked + .payment-label {\n          font-weight: 600;\n          color: #2196f3;\n        }\n\n        .payment-option:has(input[type="radio"]:checked) {\n          border-color: #2196f3;\n          background: #f0f7ff;\n          box-shadow: 0 2px 8px rgba(33, 150, 243, 0.1);\n        }\n\n        .payment-label {\n          font-size: 0.9rem;\n          color: #333;\n        }\n\n        .deposit-info {\n          margin-top: 1rem;\n          padding: 0.75rem;\n          background: #f0f7ff;\n          border-radius: 6px;\n          border-left: 3px solid #2196f3;\n        }\n\n        .deposit-info p {\n          margin: 0;\n          font-size: 0.85rem;\n          color: #1976d2;\n          font-weight: 500;\n        }\n\n        .total-amount {\n          font-size: 1.2rem;\n          margin-bottom: 1rem;\n          text-align: center;\n          color: #333;\n        }\n\n        .btn {\n          border: none;\n          border-radius: 4px;\n          padding: 0.5rem 1rem;\n          cursor: pointer;\n          font-size: 0.9rem;\n          transition: all 0.2s;\n          font-weight: 500;\n        }\n\n        .btn:hover:not(:disabled) {\n          transform: translateY(-1px);\n          box-shadow: 0 2px 8px rgba(0,0,0,0.2);\n        }\n\n        .btn:disabled {\n          opacity: 0.6;\n          cursor: not-allowed;\n        }\n\n        .btn-primary {\n          background: #2196f3;\n          color: white;\n        }\n\n        .btn-secondary {\n          background: #757575;\n          color: white;\n        }\n\n        .btn-success {\n          background: #4caf50;\n          color: white;\n        }\n\n        .btn-danger {\n          background: #f44336;\n          color: white;\n        }\n\n        .btn-small {\n          padding: 0.25rem 0.5rem;\n          font-size: 0.8rem;\n        }\n\n        .btn-large {\n          padding: 0.75rem 2rem;\n          font-size: 1rem;\n          width: 100%;\n        }\n\n        @media (max-width: 768px) {\n          .order-content {\n            grid-template-columns: 1fr;\n          }\n\n          .menu-grid {\n            grid-template-columns: 1fr;\n          }\n\n          .cart-section {\n            position: static;\n          }\n\n          .cart-item {\n            grid-template-columns: 1fr;\n            gap: 0.5rem;\n          }\n\n          .item-controls {\n            flex-direction: row;\n            justify-content: space-between;\n          }\n        }\n      '})]})}}}]);
//# sourceMappingURL=678.d99ebc63.chunk.js.map